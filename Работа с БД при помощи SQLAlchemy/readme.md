# Product Parsing and REST API with FastAPI

## Описание

Этот проект представляет собой REST API для управления продуктами, которые парсятся с сайта [Maxidom](https://www.maxidom.ru).  
Данные о продуктах сохраняются в базе данных SQLite, а через API предоставляется возможность просмотра, добавления, удаления и редактирования данных.

API реализовано на основе **FastAPI** и **SQLAlchemy**.

# main.py

## Описание

Этот файл является точкой входа в приложение FastAPI. Здесь настроены маршруты для API, которые позволяют:

- Получать список продуктов.
- Получать данные о конкретном продукте.
- Добавлять, редактировать и удалять продукты.
- Запускать парсинг данных с сайта.

Кроме того, файл подключает базу данных и настраивает зависимость для работы с сессиями SQLAlchemy.

### Основные компоненты
- Настройка FastAPI.
- CRUD-эндпоинты для управления данными.
- Эндпоинт для запуска парсера.

### Важные функции
1. **read_products**: Возвращает список продуктов.
2. **read_product**: Возвращает продукт по ID.
3. **create_new_product**: Добавляет новый продукт.
4. **delete_product_endpoint**: Удаляет продукт по ID.
5. **start_parsing**: Запускает парсер.

# database.py

## Описание

Этот файл отвечает за настройку подключения к базе данных SQLite с использованием SQLAlchemy.  
Включает:
- Создание движка для базы данных.
- Настройку сессий для работы с базой.
- Определение базового класса для моделей.

### Основные компоненты
1. **DATABASE_URL**: Указывает путь к базе данных SQLite.
2. **engine**: Объект движка SQLAlchemy для подключения.
3. **SessionLocal**: Фабрика сессий для работы с базой.
4. **Base**: Базовый класс для всех моделей SQLAlchemy.

### Как используется
Все модули, работающие с базой данных, импортируют `Base`, `SessionLocal` и `engine`.


# models.py

## Описание

В этом файле описана модель данных для продукта с использованием SQLAlchemy.  
Модель `Product` соответствует таблице `products` в базе данных.

### Основные компоненты
1. **id**: Уникальный идентификатор продукта (первичный ключ).
2. **title**: Название продукта.
3. **price**: Цена продукта.

### Как используется
- Модель используется в CRUD-операциях для хранения и извлечения данных.
- Отображает структуру таблицы `products` в базе данных.


# schemas.py

## Описание

Этот файл содержит Pydantic-схемы для валидации входных и выходных данных.  
Схемы помогают гарантировать, что API получает и возвращает корректные данные.

### Основные компоненты
1. **ProductBase**: Базовая схема с полями `title` и `price`.
2. **ProductCreate**: Унаследована от `ProductBase`, используется для создания продуктов.
3. **Product**: Расширяет `ProductBase`, добавляет поле `id`.

### Как используется
- `ProductCreate` используется в эндпоинтах для добавления новых продуктов.
- `Product` возвращается клиенту в качестве ответа на запросы.


# crud.py

## Описание

Этот файл содержит функции для выполнения CRUD-операций с базой данных.  
CRUD: Create, Read, Update, Delete.

### Основные функции
1. **get_products**: Возвращает список продуктов с поддержкой пагинации.
2. **get_product**: Возвращает продукт по ID.
3. **create_product**: Создает новый продукт в базе данных.
4. **delete_product**: Удаляет продукт по ID.

### Как используется
Эти функции вызываются из эндпоинтов API в `main.py` для взаимодействия с базой данных.


# parser.py

## Описание

Содержит логику для парсинга данных с сайта [Maxidom](https://www.maxidom.ru).  
Данные о продуктах извлекаются со страницы и сохраняются в базу данных через функции из `crud.py`.

### Основные компоненты
1. **parse_products**: Главная функция, которая:
   - Обходит страницы каталога.
   - Извлекает название и цену продуктов.
   - Сохраняет данные в базу через функцию `create_product`.

### Как используется
- Парсер запускается через эндпоинт `/parse/` в `main.py`.
- Позволяет обновить базу данных, извлекая новые данные с сайта.
